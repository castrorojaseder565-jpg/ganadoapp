<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="es">
<head>
  <meta charset="UTF-8">
  <title th:text="'Ficha de Ganado: ' + ${ganado.nombre} + ' | BoviControl'">Ficha de Ganado</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Montserrat:wght@600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body {
      background-color: #F4F7F9;
      font-family: 'Roboto', sans-serif;
      padding: 40px 15px;
      color: #34495e;
      line-height: 1.6;
    }

    h1, h2 {
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      color: #33691E;
    }

    h1 { font-size: 2.5rem; margin-bottom: 30px; }
    h2 {
      font-size: 1.7rem;
      margin-top: 40px;
      margin-bottom: 25px;
      border-left: 5px solid #33691E;
      padding-left: 15px;
      color: #2E7D32;
    }

    .detail-container {
      max-width: 960px;
      margin: 0 auto;
      background: #fff;
      border-radius: 15px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      padding: 45px;
      border-top: 6px solid #00C853;
    }

    .info-card {
      background-color: #fff;
      border: 1px solid #e0e6ed;
      border-radius: 10px;
      padding: 25px;
      margin-bottom: 30px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 15px 30px;
      align-items: center;
    }

    .info-item strong {
      color: #33691E;
      font-weight: 600;
      margin-right: 8px;
    }

    .estado-salud-badge, .estado-vacuna-badge {
      font-weight: 700;
      padding: 6px 12px;
      border-radius: 20px;
      display: inline-block;
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .Saludable { background-color: #DCEDC8; color: #33691E; }
    .Enfermo { background-color: #FFCDD2; color: #D32F2F; }
    .Cuarentena { background-color: #BBDEFB; color: #1976D2; }
    .Desconocido { background-color: #E0F2F7; color: #00BCD4; }

    .Pendiente { background-color: #E0F7FA; color: #00ACC1; }
    .Vencida { background-color: #FFCDD2; color: #D32F2F; }
    .Aplicar { background-color: #FFF9C4; color: #F57F17; }

    .alert-recomendacion {
      padding: 18px 25px;
      border-radius: 10px;
      margin-bottom: 20px;
      font-size: 1rem;
      border-left: 5px solid transparent;
      background-color: #FAFAFA;
      color: #333;
      box-shadow: 0 1px 6px rgba(0,0,0,0.05);
    }

    .alert-reporte-limites { border-left-color: #E57373; background-color: #FDECEA; }
    .alert-nutricional { border-left-color: #81C784; background-color: #F1F8E9; }
    .alert-vacunas { border-left-color: #4DD0E1; background-color: #E0F7FA; }

    .alert-recomendacion strong { color: #2E7D32; }

    .recomendacion-section { margin-bottom: 20px; }
    .recomendacion-section ul {
      list-style-type: disc;
      padding-left: 20px;
      margin-top: 8px;
    }
    .recomendacion-section li {
      margin-bottom: 6px;
      line-height: 1.4;
    }

    .vacuna-list {
      list-style: none;
      padding: 0;
      margin-top: 10px;
    }

    .vacuna-list li {
      background-color: #FAFAFA;
      border: 1px solid #e0e6ed;
      border-radius: 8px;
      padding: 14px 20px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.95rem;
      transition: all 0.25s ease;
    }

    .vacuna-list li:hover {
      background-color: #E8F5E9;
      transform: translateY(-2px);
    }

    .no-vacunas {
      text-align: center;
      color: #888;
      font-style: italic;
      margin-top: 10px;
    }

    .btn-group-actions {
      display: flex;
      justify-content: center;
      margin-top: 35px;
      gap: 15px;
      flex-wrap: wrap;
    }

    .btn-action-custom {
      padding: 10px 20px;
      font-size: 0.95rem;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-back { background-color: #00C853; color: white; }
    .btn-edit-ganado { background-color: #33691E; color: white; }
    .btn-edit-vacunas { background-color: #00796B; color: white; }

    .btn-action-custom:hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }
  </style>
</head>

<body>
<div class="detail-container">

  <h1 class="text-center mb-4">
    Ficha de Ganado: <span th:text="${ganado.nombre != null ? ganado.nombre : 'No registrado'}"></span>
  </h1>

  <div th:if="${mensaje}" class="alert-recomendacion alert-nutricional text-center fw-semibold">
    <span th:text="${mensaje}"></span>
  </div>

  <div th:if="${error}" class="alert-recomendacion alert-reporte-limites text-center fw-semibold">
    <span th:text="${error}"></span>
  </div>

  <h2>Datos Principales</h2>
  <div class="info-card">
    <div class="info-item"><strong>ID:</strong> <span th:text="${ganado.id}">No registrado</span></div>
    <div class="info-item"><strong>Raza:</strong> <span th:text="${ganado.raza != null ? ganado.raza : 'No registrada'}"></span></div>
    <div class="info-item"><strong>Edad:</strong> <span th:text="${edadFormateada != null ? edadFormateada : 'No registrada'}">No registrada</span></div>
    <div class="info-item"><strong>Peso:</strong> <span th:text="${ganado.peso != null ? ganado.peso + ' kg' : 'No registrado'}"></span></div>
    <div class="info-item"><strong>Sexo:</strong> <span th:text="${ganado.sexo != null ? ganado.sexo : 'No registrado'}"></span></div>
    <div class="info-item">
      <strong>Estado de Salud:</strong>
      <span th:text="${ganado.estadoSalud != null ? ganado.estadoSalud : 'Desconocido'}"
            th:class="'estado-salud-badge ' + (${ganado.estadoSalud != null && !ganado.estadoSalud.isEmpty() ? ganado.estadoSalud : 'Desconocido'})">
      </span>
    </div>
  </div>

  <h2>Observaciones y Recomendaciones</h2>

  <div th:if="${reporteLimites != null}" class="alert-recomendacion alert-reporte-limites">
    <p th:utext="${reporteLimites}"></p>
  </div>

  <div th:if="${recomendacionNutricional}" class="alert-recomendacion alert-nutricional">
    <p th:utext="${recomendacionNutricional}"></p>
  </div>

  <div class="alert-recomendacion alert-vacunas" th:if="${recomendacionVacuna}">
    <p><strong>Recomendaciones de Vacunación y Manejo Sanitario:</strong></p>
    <div th:utext="${recomendacionVacuna}" class="recomendacion-section"></div>
  </div>

  <h2>Vacunas Registradas</h2>

  <div th:if="${vacunas != null and !vacunas.isEmpty()}">
    <ul class="vacuna-list">
      <li th:each="vac : ${vacunas}">
        <span>
          <strong th:text="${vac.nombre != null ? vac.nombre : 'Vacuna sin nombre'}">Vacuna</strong> — aplicada el
          <span th:text="${vac.fechaAplicacion != null ? #temporals.format(vac.fechaAplicacion, 'dd/MM/yyyy') : 'Fecha no registrada'}">[Fecha]</span>
          <span th:text="'Estado: ' + (${vac.estado != null && !vac.estado.isEmpty() ? vac.estado : 'Pendiente'})"
                th:class="'estado-vacuna-badge ' + (${vac.estado != null && !vac.estado.isEmpty() ? vac.estado : 'Pendiente'})"></span>
        </span>
      </li>
    </ul>
  </div>

  <div th:if="${vacunas == null or vacunas.isEmpty()}" class="no-vacunas">
    <p>No se han registrado vacunas para este ganado aún. Se recomienda seguir el plan sanitario general establecido para la raza y categoría productiva.</p>
  </div>

  <div class="btn-group-actions">
    <a th:href="@{/ganado/lista}" class="btn-action-custom btn-back">Volver a la Lista</a>
    <a th:href="@{'/ganado/editar/' + ${ganado.id}}" class="btn-action-custom btn-edit-ganado"
       sec:authorize="hasRole('ADMIN')">Editar Ganado</a>
    <a th:href="@{'/vacuna/editar/' + ${ganado.id}}" class="btn-action-custom btn-edit-vacunas"
       sec:authorize="hasRole('VETERINARIO')">Editar Vacunas</a>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>



